import{L as k}from"./index-WUXkvdkE.js";/* empty css              */import{S as _}from"./sweetalert2.all-eK8a_lGc.js";import{P as M}from"./PaginationView-weOvm_6T.js";import{M as x}from"./bootstrap.esm-l9cKv-78.js";import{a as r}from"./axios-G2rPRu76.js";import{_ as A,c as d,b as t,F as b,i as L,z as i,D as c,t as u,E as V,d as w,h as C,e as E,r as g,o as l}from"./index-YU522o6f.js";import"./_commonjsHelpers-1J56E-h6.js";var U={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:m,VITE_APP_API_NAME:h}=U,D={data(){return{isLoading:!1,date:"",modal:!0,ariticleData:{},articleModal:"",pagination:{},dataId:"",data:{title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""}}},methods:{getAriticle(){r.get(`${m}/v2/api/${h}/admin/articles`).then(s=>{this.ariticleData=s.data,this.pagination=s.data.pagination}).catch(s=>{alert(s.data.message).error(s)}).finally(()=>{this.isLoading=!1})},openEditModla(s){this.isLoading=!0,r.get(`${m}/v2/api/${h}/admin/article/${s.id}`).then(e=>{this.data={...e.data.article},this.articleModal.show()}).catch(e=>{alert(e.data.message).error(e)}).finally(()=>{this.isLoading=!1}),this.modal=!1,this.date=s.create_at,this.data.create_at=this.time(s.create_at),this.dataId=s.id},openModal(){this.modal=!0,this.data={title:"",description:"",image:"",tag:"",create_at:"",author:"",isPublic:!1,content:""},this.articleModal.show()},newArticle(){if(this.modal===!0){this.timeChange();const s={...this.data};r.post(`${m}/v2/api/${h}/admin/article`,{data:s}).then(e=>{e.success===!0&&this.articleModal.hide(),this.data={},_.fire(`${e.data.message}`),this.getAriticle()}).catch(e=>{alert(e.data.message).error(e)})}else{this.timeChange();const s={...this.data};r.put(`${m}/v2/api/${h}/admin/article/${this.dataId}`,{data:s}).then(e=>{e.success===!0&&this.articleModal.hide(),this.data={},this.getAriticle(),_.fire(`${e.data.message}`)}).catch(e=>{alert(e.data.message).error(e)})}},timeChange(){const s=new Date(this.data.create_at);s.setHours(0,0,0,0);const e=s.getTime()/1e3;this.data.create_at=e},time(s){const e=new Date(s*1e3),p={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return e.toLocaleString("zh-TW",p)},delArticle(s){r.delete(`${m}/v2/api/${h}/admin/article/${s}`).then(e=>{this.getAriticle(),_.fire(`${e.data.message}`)}).catch(e=>{alert(e.data.message).error(e)})},changePage(s){this.getProducts(s)}},components:{Loading:k,Pagination:M},mounted(){this.isLoading=!0,this.getAriticle(),this.articleModal=new x(this.$refs.articleModal)}},I={class:"container"},S={class:"text-end mt-4"},T={class:"table mt-4"},B=t("thead",null,[t("tr",null,[t("th",null,"文章名稱"),t("th",null," 日期 "),t("th",null," 作者 "),t("th",null," 是否啟用 "),t("th",null," 編輯 ")])],-1),N={key:0,class:"text-secondary"},R={key:1},z={class:"btn-group"},F=["onClick"],O=["onClick"],H={id:"productModal",ref:"articleModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},W={class:"modal-dialog modal-xl"},j={class:"modal-content border-0"},q=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{id:"productModalLabel",class:"modal-title"},[t("span",null,"新增產品")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),G={class:"modal-body"},J={class:"row"},K={class:"col-sm-4"},Q={class:"mb-2"},X={class:"mb-3"},Y=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),Z=t("img",{class:"img-fluid",src:"",alt:"要新增的圖片"},null,-1),$=t("div",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")],-1),tt={class:"col-sm-8"},et={class:"mb-3"},at=t("label",{for:"title",class:"form-label"},"標題",-1),st={class:"row"},ot={class:"mb-3 col-md-6"},it=t("label",{for:"category",class:"form-label"},"作者",-1),lt={class:"row"},nt={class:"mb-3 col-md-6"},dt=t("label",{for:"origin_price",class:"form-label"},"標籤",-1),ct={class:"mb-3 col-md-6"},rt={key:0,for:"date",class:"form-label"},mt={key:1,for:"date"},ht=t("hr",null,null,-1),ut={class:"mb-3"},_t=t("label",{for:"description",class:"form-label"},"文章描述",-1),pt={class:"mb-3"},bt=t("label",{for:"content",class:"form-label"},"這是內容",-1),gt={class:"mb-3"},ft={class:"form-check"},vt=t("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),yt={class:"modal-footer"},Pt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function kt(s,e,p,Mt,o,n){const f=g("Loading"),v=g("Pagination");return l(),d(b,null,[t("div",I,[t("div",S,[t("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=a=>n.openModal())}," 建立新的文章 ")]),t("table",T,[B,t("tbody",null,[(l(!0),d(b,null,L(o.ariticleData.articles,(a,y)=>(l(),d("tr",{key:y},[t("td",null,u(a.title),1),t("td",null,u(n.time(a.create_at)),1),t("td",null,u(a.author),1),t("td",null,[a.isPublic?(l(),d("span",N,"啟用")):(l(),d("span",R,"未啟用"))]),t("td",null,[t("div",z,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:P=>n.openEditModla(a)}," 編輯 ",8,F),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:P=>n.delArticle(a.id)}," 刪除 ",8,O)])])]))),128))])])]),t("div",H,[t("div",W,[t("div",j,[q,t("div",G,[t("div",J,[t("div",K,[t("div",Q,[t("div",X,[Y,i(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[1]||(e[1]=a=>o.data.image=a)},null,512),[[c,o.data.image]])]),Z]),$]),t("div",tt,[t("div",et,[at,i(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=a=>o.data.title=a)},null,512),[[c,o.data.title]])]),t("div",st,[t("div",ot,[it,i(t("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=a=>o.data.author=a),placeholder:"請輸入作者"},null,512),[[c,o.data.author]])])]),t("div",lt,[t("div",nt,[dt,i(t("input",{id:"origin_price",type:"text",min:"0",class:"form-control",placeholder:"請輸入標籤","onUpdate:modelValue":e[4]||(e[4]=a=>o.data.tag=a)},null,512),[[c,o.data.tag]])]),t("div",ct,[o.date?(l(),d("label",mt,"發布日期:"+u(n.time(o.date)),1)):(l(),d("label",rt,"日期")),i(t("input",{id:"date",type:"date",min:"0",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=a=>o.data.create_at=a),placeholder:"請輸入日期"},null,512),[[c,o.data.create_at]])])]),ht,t("div",ut,[_t,i(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=a=>o.data.description=a),placeholder:"請輸入產品 描述"},`
                      `,512),[[c,o.data.description]])]),t("div",pt,[bt,i(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=a=>o.data.content=a),placeholder:"請輸入說明內容"},`
                      `,512),[[c,o.data.content]])]),t("div",gt,[t("div",ft,[i(t("input",{type:"checkbox",class:"form-check-input",id:"is_enabled","onUpdate:modelValue":e[8]||(e[8]=a=>o.data.isPublic=a)},null,512),[[V,o.data.isPublic]]),vt])])])])]),t("div",yt,[Pt,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=a=>n.newArticle())}," 確認 ")])])])],512),w(f,{active:o.isLoading,"onUpdate:active":e[10]||(e[10]=a=>o.isLoading=a)},null,8,["active"]),o.pagination.total_pages>=2?(l(),C(v,{key:0,pagination:o.pagination,onChangePage:n.changePage},null,8,["pagination","onChangePage"])):E("",!0)],64)}const Dt=A(D,[["render",kt]]);export{Dt as default};

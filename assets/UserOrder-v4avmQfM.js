import{a as h}from"./axios-G2rPRu76.js";import{L as k}from"./index-WUXkvdkE.js";/* empty css              */import{S as b}from"./sweetalert2.all-eK8a_lGc.js";import{M as g}from"./bootstrap.esm-l9cKv-78.js";import{P as D}from"./PaginationView-weOvm_6T.js";import{_ as C,c as d,b as e,F as u,i as _,d as f,t as a,e as I,r as v,o as i}from"./index-YU522o6f.js";import"./_commonjsHelpers-1J56E-h6.js";var L={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_API_NAME:"ssozr",BASE_URL:"/vue2024week62/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:m,VITE_APP_API_NAME:p}=L,O={data(){return{show:!1,isLoading:!1,orders:[],delModal:"",delModalId:"",orderModal:"",orderModalId:"",orderData:"",pagination:{},page:"",paidDisabled:!1}},components:{Loading:k,Pagination:D},methods:{getOrders(s=1){h.get(`${m}/v2/api/${p}/admin/orders/?page=${s}`).then(t=>{this.orders=t.data.orders,this.pagination=t.data.pagination}).catch(t=>{alert(t.data.message).error(t)}).finally(()=>{this.isLoading=!1})},opDelModal(s){this.delModalId=s,this.delModal.show()},deleteOrder(){const s=this.delModalId;h.delete(`${m}/v2/api/${p}/admin/order/${s}`).then(t=>{b.fire(`${t.data.message}`),this.getOrders(),this.delModal.hide()}).catch(t=>{alert(t.data.message).error(t)})},opOrderModal(s){this.orderModal.show(),this.orderData={...s}},upDataPaid(s){this.paidDisabled=!0;const t={is_paid:!s.is_paid};h.put(`${m}/v2/api/${p}/admin/order/${s.id}`,{data:t}).then(n=>{b.fire(`${n.data.message}`),this.getOrders()}).catch(n=>{alert(n.data.message).error(n)}).finally(()=>{this.paidDisabled=!1})},changePage(s){this.getOrders(s)},time(s){const t=new Date(s*1e3),n={year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleString("zh-TW",n)}},mounted(){this.isLoading=!0,this.getOrders(),this.delModal=new g(this.$refs.delModal),this.orderModal=new g(this.$refs.orderModal)}},A={class:"container"},E={class:"table"},w=e("thead",null,[e("tr",null,[e("th",null,"購買時間"),e("th",null,"Email"),e("th",null,"購買款項"),e("th",null,"應付金額"),e("th",null,"是否付款"),e("th",null,"編輯")])],-1),x={class:"list-unstyled"},V={class:"form-check form-switch"},S=["disabled","checked","onClick"],N=["for"],R={key:0},T={key:1},U=["onClick"],B=["onClick"],q={class:"modal",tabindex:"-1",id:"delModal",ref:"delModal"},z={class:"modal-dialog"},F={class:"modal-content"},$=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"確認刪除?"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),W={class:"modal-body"},j={class:"modal-footer"},G=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1),H={class:"modal",tabindex:"-1",id:"orderModal",ref:"orderModal"},J={class:"modal-dialog"},K={class:"modal-content"},Q={class:"modal-header"},X={class:"modal-title"},Y=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Z={class:"modal-body"},ee={key:0};function te(s,t,n,oe,l,r){const y=v("Pagination"),M=v("loading");return i(),d(u,null,[e("div",A,[e("table",E,[w,e("tbody",null,[(i(!0),d(u,null,_(l.orders,o=>(i(),d("tr",{key:o.id},[e("td",null,a(r.time(o.create_at)),1),e("td",null,a(o.user.email),1),e("td",null,[e("ul",x,[(i(!0),d(u,null,_(o.products,(c,P)=>(i(),d("li",{key:P},a(c.product.title)+"*"+a(c.qty)+"="+a(c.total),1))),128))])]),e("td",null,a(o.total),1),e("td",null,[e("div",V,[e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"item.id",disabled:l.paidDisabled,checked:o.is_paid,onClick:c=>r.upDataPaid(o)},null,8,S),e("label",{class:"form-check-label",for:o.id},[o.is_paid?(i(),d("p",R,"已付款")):(i(),d("p",T,"未付款"))],8,N)])]),e("td",null,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opOrderModal(o)},"檢視",8,U),e("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>r.opDelModal(o.id)},"刪除",8,B)])]))),128))])]),f(y,{pagination:l.pagination,onChangePage:r.changePage},null,8,["pagination","onChangePage"]),f(M,{active:l.isLoading,"onUpdate:active":t[0]||(t[0]=o=>l.isLoading=o)},null,8,["active"])]),e("div",q,[e("div",z,[e("div",F,[$,e("div",W,[e("p",null,"訂單編號:"+a(l.delModalId),1)]),e("div",j,[G,e("button",{type:"button",onClick:t[1]||(t[1]=o=>r.deleteOrder()),class:"btn btn-primary"},"確定刪除")])])])],512),e("div",H,[e("div",J,[e("div",K,[e("div",Q,[e("h5",X,"訂單編號"+a(l.orderData.id),1),Y]),e("div",Z,[e("ul",null,[(i(!0),d(u,null,_(l.orderData.products,o=>(i(),d("li",{key:o.id},a(o.product.title)+" 數量:"+a(o.qty),1))),128))]),l.orderData?(i(),d("ul",ee,[e("li",null,"訂單人姓名"+a(l.orderData.user.name),1),e("li",null,"信箱"+a(l.orderData.user.email),1),e("li",null,"電話"+a(l.orderData.user.tel),1),e("li",null,"備註"+a(l.orderData.user.address),1)])):I("",!0)])])])],512)],64)}const ue=C(O,[["render",te]]);export{ue as default};
